from kafka import KafkaProducer
from kafka.errors import KafkaError
import json
 
producer = KafkaProducer(bootstrap_servers=['vm-cdl-d-10:9092'])
#topic = "topic-test"
topic = "Hello-Kafka" 
origdate = 1495570948666
msg = "idiot sandwich"

#msg_to_encode = "2016-08-01T06:43:18.739785;1470044596.744688000;172.30.20.1;17;64;4;0;0;0x0000012c;0;20;0x0000f7cd;2;0x00000000;0x00000000;0;425;0;0;172.30.20.13;0x00007715;2;22884;405;53,22884;53;11;;;;1;14;0;0;1;;;;;;;;;;;;0x000081b0;1;0;1;0;0;1;1;1;0;0;0x00003abf;a.root-servers.net,b.root-servers.net,c.root-servers.net,d.root-servers.net,e.root-servers.net,f.root-servers.net,g.root-servers.net,h.root-servers.net,i.root-servers.net,j.root-servers.net,k.root-servers.net,l.root-servers.net,m.root-servers.net;;0x00000001;<Root>;0;2;0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001;0;0x00000000;20,4,4,4,4,4,4,4,4,4,4,4,4,147,0;<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>;60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160;2,2,2,2,2,2,2,2,2,2,2,2,2,46,41;0x00008000;1;0x00000000;62;4096;8;46551;0;518400;Aug 10, 2016 14:00:00.000000000 Hora oficial do Brasil;Jul 31, 2016 13:00:00.000000000 Hora oficial do Brasil;<Root>;2;;;;;;;;0.003226000"
#msg_to_encode = "2016-08-01T06:43:18.739785;2016-08-01;1470044597.030104000;172.30.20.1;17;64;4;0;0;0x0000ca5d;0;20;0x00002f45;2;0x00000000;0x00000000;0;256;0;0;203.119.86.101;0x000021df;2;49278;236;53,49278;53;7;202.12.28.140;;;1;2;0;3;1;;;;;;;;;;;;0x000081b0;1;0;1;0;0;1;1;1;0;0;0x0000ae00;;;0x00000001;sec3.apnic.net;14;1;0x00000001,0x00000001;0;0x00000000;4,157,0;sec3.apnic.net,sec3.apnic.net,<Root>;3600,3600;1,46,41;0x00008000;1;0x00000000;58;4096;8;41811;3;3600;Aug 30, 2016 21:48:38.000000000 Hora oficial do Brasil;Jul 31, 2016 20:48:38.000000000 Hora oficial do Brasil;apnic.net;1;;;;;;;;0.289312000"
msg_to_encode= "2016-08-01T06:43:18.739785;2016-08-01;1470044596.744688000;172.30.20.1;17;64;4;0;0;0x0000012c;0;20;0x0000f7cd;2;0x00000000;0x00000000;0;425;0;0;172.30.20.13;0x00007715;2;22884;405;53,22884;53;11;;;;1;14;0;0;1;;;;;;;;;;;;0x000081b0;1;0;1;0;0;1;1;1;0;0;0x00003abf;a.root-servers.net,b.root-servers.net,c.root-servers.net,d.root-servers.net,e.root-servers.net,f.root-servers.net,g.root-servers.net,h.root-servers.net,i.root-servers.net,j.root-servers.net,k.root-servers.net,l.root-servers.net,m.root-servers.net;;0x00000001;<Root>;0;2;0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001,0x00000001;0;0x00000000;20,4,4,4,4,4,4,4,4,4,4,4,4,147,0;<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>,<Root>;60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160;2,2,2,2,2,2,2,2,2,2,2,2,2,46,41;0x00008000;1;0x00000000;62;4096;8;46551;0;518400;Aug 10, 2016 14:00:00.000000000 Hora oficial do Brasil;Jul 31, 2016 13:00:00.000000000 Hora oficial do Brasil;<Root>;2;;;;;;;;0.003226000"
producer.send(topic,msg_to_encode.encode('utf-8'))
